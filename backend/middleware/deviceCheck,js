import DeviceModel from '../models/DeviceModel.js';

export const checkDevice = async (req, res, next) => {
  const { userId, deviceId } = req.body;

  const active = await DeviceModel.findOne({ userId, deviceId });

  if (!active) {
    return res.status(401).json({ error: 'Device not authorized.' });
  }

  next();
};
